#include <stdio.h>
#include <math.h>

void mlp(double *x, double *x3) {
    double input_M[] = {110.09904485826374, 110.09907642880054, 63.38890867314894, 23.686764049013096, 53.93364940657935, 50.83202844378558, 56.80248606863049, 56.678333966887884, 53.93364940657926, 50.83202844378592, 49.863991630308576, 50.0579118202628};
    double input_V[] = {30.36922000700369, 67.29187443852076, 19.979507413076345, 15.822699971474378, 10.080807757952243, 9.45275145948344, 3.3267885700729476, 3.3770616375808955, 23.91033480590317, 22.712412966959775, 16.76576449140994, 17.07467007392964};
    double w1[12][12] = {{0.013076680712401867, -0.017584331333637238, 0.08916649222373962, 0.27315518260002136, 0.4822162687778473, -0.24896371364593506, -0.3112044930458069, -0.19949282705783844, 1.5964635610580444, -0.1084865853190422, -0.875853419303894, 0.5012179017066956}, {0.1549563854932785, 1.3547141551971436, 0.4291216731071472, -0.6341755390167236, 0.20710186660289764, -0.18692630529403687, -0.9388120174407959, 0.873826265335083, 0.17191442847251892, -0.13733595609664917, 0.19798974692821503, 0.37350526452064514}, {-0.3528132140636444, 0.021352026611566544, 1.613418459892273, -0.06576375663280487, -0.20829147100448608, 1.550421953201294, -1.35093092918396, -1.066143274307251, 0.11840717494487762, -0.049324214458465576, -0.12208458036184311, 0.061255279928445816}, {-0.07709574699401855, 0.04197138175368309, -0.4079781472682953, -0.12180591374635696, 1.2276277542114258, -0.8844823837280273, -2.9891254901885986, 2.8126578330993652, -0.08139097690582275, -0.028140179812908173, 0.047498155385255814, 0.15970726311206818}, {-0.6086990833282471, 0.19460898637771606, 0.8485351204872131, -0.12701377272605896, 1.556845784187317, -2.293039083480835, 1.7834824323654175, -2.234269618988037, 0.06258835643529892, 0.032765209674835205, -0.252743124961853, -0.24589210748672485}, {1.1988589763641357, -0.1754162758588791, 0.46528714895248413, -0.0140718137845397, 1.2700884342193604, 1.615431785583496, -0.5904748439788818, -1.5268275737762451, 0.28771379590034485, 0.12735606729984283, 0.07419151067733765, 0.01564054936170578}, {0.2199849784374237, -0.30060869455337524, 0.42097291350364685, -0.41124942898750305, 0.41523200273513794, 0.3726368546485901, -0.7755225896835327, -0.5469105839729309, -0.8825734257698059, 0.03964943438768387, -1.7863789796829224, -0.14862850308418274}, {-0.12491098046302795, 0.2348380833864212, 1.4521520137786865, 0.10330554097890854, 2.497347354888916, 1.387648582458496, -0.9273590445518494, -1.7924189567565918, -0.16751587390899658, -0.021871572360396385, 0.06219274550676346, -0.1685715764760971}, {0.399100124835968, 0.9522078037261963, -0.40735092759132385, 0.9714404344558716, 0.617002010345459, -2.0297648906707764, 0.181608647108078, 0.35113203525543213, 0.1959066241979599, 0.16959801316261292, 0.24653378129005432, -0.5214922428131104}, {0.17813806235790253, -0.03890445455908775, -0.6749618649482727, 0.9072875380516052, -0.319895476102829, 2.8291265964508057, -0.30663883686065674, 0.08510230481624603, -0.03925948962569237, 0.04944969341158867, 0.09458790719509125, -0.4273187816143036}, {0.15021607279777527, 1.1738978624343872, -0.2140832543373108, 0.215134859085083, -0.8677523732185364, 0.8261789679527283, 0.6321144700050354, 0.20387819409370422, 0.10912898927927017, -0.0670684427022934, -0.2301686704158783, -0.15958437323570251}, {-0.7792290449142456, 0.4084628224372864, -1.8593069314956665, 0.010259960778057575, -1.029363989830017, -0.20686762034893036, 0.20438210666179657, 1.5629600286483765, 0.18084505200386047, -0.0687807947397232, 0.041492678225040436, 0.271150141954422}}; 
    double b1[] = {0.7924067974090576, 1.567685842514038, -1.8500696420669556, -0.5936020612716675, -0.4556398093700409, -0.5545506477355957, 1.8642137050628662, 1.1632709503173828, -0.3470301032066345, -1.0906810760498047, -0.5338025689125061, -0.22068598866462708};
    double w2[12][12] = {{0.8013955354690552, -0.3446492850780487, -0.9702643156051636, 0.9118624329566956, -0.7937814593315125, 0.4526783525943756, 0.40137001872062683, 1.8773199319839478, 0.18195147812366486, -0.2050820291042328, -0.9861586093902588, -0.4056358337402344}, {0.18362778425216675, 1.0789076089859009, 0.0932484045624733, 0.5868199467658997, 0.1647471785545349, -1.2933039665222168, 0.09030231088399887, -0.8777371048927307, 0.010288302786648273, -0.8451183438301086, 0.8152927160263062, 0.002720949938520789}, {-0.428605854511261, -0.7660140991210938, 0.34983137249946594, 0.4935312867164612, -0.4564274847507477, -0.5719868540763855, -0.2216591089963913, -0.3110244572162628, -0.10838145762681961, 1.2720056772232056, 0.2508361339569092, -1.4613418579101562}, {-0.6324496865272522, 0.4394311010837555, -0.6210015416145325, -2.7078676223754883, 0.09993559867143631, 1.235399603843689, -0.17713674902915955, 0.927012026309967, 0.09052984416484833, -0.6790302991867065, 0.2275252789258957, 1.5214719772338867}, {-0.7524738311767578, 0.05382997915148735, 1.1509822607040405, -0.8546584248542786, -0.8029772043228149, -0.9612919092178345, -0.5529247522354126, -0.3895531892776489, -0.3636508584022522, -0.3805546760559082, -0.23182779550552368, 0.3913871943950653}, {-0.009333480149507523, -0.7657455205917358, 0.5699111223220825, -0.009637180715799332, 0.5320610404014587, 0.09895684570074081, 0.018621103838086128, -0.7636045813560486, 0.6509674191474915, -0.6162641048431396, 1.6612085103988647, 0.3743153214454651}, {-0.27737829089164734, 0.08753488212823868, 2.0760011672973633, -1.9886313676834106, -1.7707422971725464, -0.43973127007484436, -0.13508258759975433, -1.248754620552063, 0.2528899312019348, -0.2547011077404022, 0.5865025520324707, 1.1958271265029907}, {0.5956438779830933, -0.11896324157714844, -0.07674149423837662, 0.6424780488014221, -0.1792186200618744, 0.10117319226264954, 0.7402403950691223, 1.9532396793365479, 1.4243545532226562, -0.5523646473884583, -0.4612678587436676, 0.4457351267337799}, {0.22065554559230804, -1.5394253730773926, -0.05107392370700836, -0.6065717339515686, -0.1310352236032486, 0.28104403614997864, 0.14076882600784302, 1.8593993186950684, -0.085434690117836, -1.1389801502227783, 0.5633463859558105, 0.5692005753517151}, {-0.2519019544124603, 0.6848828196525574, 0.0020513494964689016, 1.0052505731582642, -0.2644181251525879, -1.386256456375122, -0.2944521903991699, -0.7246547937393188, 0.3706972599029541, -0.13771174848079681, -0.8655180335044861, 0.2522070109844208}, {-1.0657159090042114, 0.6584510803222656, 0.5388469696044922, -0.25956156849861145, -1.0314034223556519, 0.9600478410720825, -1.3223344087600708, -0.07275524735450745, 0.26890578866004944, 0.9385932683944702, -0.8699110746383667, 0.47378823161125183}, {-0.7757793068885803, 0.02535064145922661, 0.7755530476570129, -0.3462064266204834, -0.22206908464431763, -1.083000898361206, -0.8239592909812927, 0.656909704208374, 0.9958383440971375, 0.848030149936676, 0.4595019817352295, -0.465431809425354}};
    double b2[] = {-0.47689303755760193, 0.9297180771827698, 0.6492601633071899, 0.5517168641090393, 1.0508970022201538, 1.0216422080993652, -0.17924590408802032, 1.0634312629699707, 0.47052595019340515, 0.3115358054637909, -0.302204966545105, 1.219007968902588};
    double w3[3][12] = {{-1.8421159982681274, 1.5046907663345337, 1.263110637664795, -1.0544729232788086, 0.4029009938240051, 1.2643893957138062, -0.3723159730434418, -1.692844033241272, 1.4860211610794067, -0.595160722732544, 0.6960592269897461, 1.2429906129837036}, {0.8352085947990417, -1.8215893507003784, -0.5513759255409241, -1.2179940938949585, -1.569230079650879, -1.0064902305603027, -2.1252989768981934, -0.3954193592071533, -0.12817850708961487, -0.884064793586731, -1.8847852945327759, -1.8759071826934814}, {1.0068583488464355, 0.3234846293926239, -0.7069582939147949, 2.2893660068511963, 1.1733471155166626, -0.26917797327041626, 2.4915242195129395, 2.0897037982940674, -1.354357361793518, 1.4872509241104126, 1.1899983882904053, 0.6327081322669983}};
    double b3[] = {2.121095895767212, -0.3287118971347809, -1.7891498804092407};

    double x1[12], x2[12];

    // normalization
    for(int i=0; i<12; ++i)
        x[i] = (x[i]-input_M[i]) / input_V[i];

    // Linear
    for(int i=0; i<12; ++i) {
        for(int j=0; j<12; ++j) {
            x1[i] += w1[i][j]*x[j];
        }
        x1[i] += b1[i];
    }
    // tanh
    for(int i=0; i<12; ++i)
        x1[i] = tanh(x1[i]);

    // Linear
    for(int i=0; i<12; ++i) {
        for(int j=0; j<12; ++j) {
            x2[i] += w2[i][j]*x1[j];
        }
        x2[i] += b2[i];
    }
    // tanh
    for(int i=0; i<12; ++i)
        x2[i] = tanh(x2[i]);

    // Linear
    for(int i=0; i<3; ++i) {
        for(int j=0; j<12; ++j) {
            x3[i] += w3[i][j]*x2[j];
        }
        x3[i] += b3[i];
    }

    //printf("%f, %f, %f\n", x3[0], x3[1], x3[2]);
}